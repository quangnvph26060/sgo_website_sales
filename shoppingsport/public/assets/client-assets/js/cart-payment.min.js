(() => {
    function t(e) {
        return (
            (t =
                "function" == typeof Symbol &&
                "symbol" == typeof Symbol.iterator
                    ? function (t) {
                          return typeof t;
                      }
                    : function (t) {
                          return t &&
                              "function" == typeof Symbol &&
                              t.constructor === Symbol &&
                              t !== Symbol.prototype
                              ? "symbol"
                              : typeof t;
                      }),
            t(e)
        );
    }
    function e(e) {
        $.ajax({
            headers: {
                "X-CSRF-TOKEN": $('meta[name="csrf-token"]').attr("content"),
            },
            url: "/ajax/load-shipping-fee",
            type: "POST",
            dataType: "json",
            data: e,
            beforeSend: function () {
                loadingBox();
            },
            success: function (i) {
                $(".list-shipping .radio-field__description").empty(),
                    void 0 === t(i.appendAble)
                        ? $(".list-service_" + e.shipping_method).hide()
                        : $(".list-service_" + e.shipping_method).show(),
                    i.status
                        ? (void 0 !== t(i.appendAble) &&
                              $(".list-service_" + e.shipping_method).append(
                                  i.html
                              ),
                          $(".shipping-amount").text(i.shippingFeeServiceFm),
                          $(".summary-total-price").text(i.totalOrder))
                        : alert_show("error", i.message),
                    loadingBox("close");
            },
            error: function () {
                loadingBox("close"), alert_show("error", errorMessage);
            },
        });
    }
    function i(t) {
        return t
            ? t
                  .replace(/[áàảãạâấầẩẫậăắằẳẵặ]/gi, "a")
                  .replace(/[đ]/gi, "d")
                  .replace(/[éèẻẽẹêếềểễệ]/gi, "e")
                  .replace(/[íìỉĩị]/gi, "i")
                  .replace(/[óòỏõọôốồổỗộơớờởỡợ]/gi, "o")
                  .replace(/[ýỳỷỹỵ]/gi, "y")
                  .replace(/[úùủũụưứừửữự]/gi, "u")
                  .replace(/\s+/gi, "-")
                  .replace(/[-]+/gi, "-")
                  .replace(/^[-]+|[-]+$/gi, "")
                  .replace(/[^a-z0-9-]/gi, "")
                  .toLowerCase()
            : "";
    }
    $(document).ready(function () {
        $("body").on("click", "td .action-cart", function (t) {
            var e = $(this),
                i = e.data("id"),
                o = e.data("type");
            ("delete" != o || confirm($(this).data("confirm"))) &&
                $.ajax({
                    headers: {
                        "X-CSRF-TOKEN": $('meta[name="csrf-token"]').attr(
                            "content"
                        ),
                    },
                    type: "post",
                    dataType: "json",
                    data: { rowId: i, type: o },
                    url: "edit-cart",
                    success: function (t) {
                        "success" == t.type &&
                            ($("table tbody").empty(),
                            $(".cart-count").text(t.count),
                            $(".summary-total-price").text(t.totalPrice),
                            $(".subTotalcart").text(t.totalPrice),
                            $("table tbody").append(t.html)),
                            t.count ||
                                setTimeout(function () {
                                    window.location.reload();
                                }, 1500),
                            alert_show(t.type, t.message);
                    },
                    error: function (t) {
                        alert_show("error", errorMessage);
                    },
                });
        }),
            $(".form-control").on("click keyup", function (t) {
                $(this).css({ border: "1px solid #CED4DA" });
            }),
            $("body").on("click", ".form-infor .search_address", function (t) {
                $(this).parent().toggleClass("active"),
                    $(this).parent().find(".err_show").removeClass("active");
            }),
            $("body").on(
                "keyup",
                ".form-infor .address-suggest .filter .name",
                function (t) {
                    var e = $.trim($(this).val()).toLowerCase(),
                        o = i(e);
                    e.length > 0
                        ? $(this)
                              .closest(".address-suggest")
                              .find(
                                  ".address-suggest__group >.address-suggest-item"
                              )
                              .each(function () {
                                  var t = $(this).text().toLowerCase();
                                  -1 != t.indexOf(e) || -1 != i(t).indexOf(o)
                                      ? $(this).css("display", "block")
                                      : $(this).css("display", "none");
                              })
                        : $(this)
                              .closest(".address-suggest")
                              .find(
                                  ".address-suggest__group >.address-suggest-item"
                              )
                              .each(function () {
                                  $(this).css("display", "");
                              });
                }
            ),
            $(document).mouseup(function (t) {
                var e = $(".address-suggest");
                e.is(t.target) ||
                    0 !== e.has(t.target).length ||
                    e.parent().removeClass("active");
            }),
            $("body").on(
                "click",
                ".form-infor .address-suggest li.address-suggest-item",
                function () {
                    var t = $(this),
                        e = t.data("type"),
                        i = "#search_address_district",
                        o = (t.closest("form-infor").data("id"), "district");
                    "ward" == e &&
                        (t
                            .closest(".form-infor")
                            .find("input[name=ward_id]")
                            .val(t.data("id")),
                        t
                            .closest(".form-infor")
                            .find("#customer_ward_id")
                            .text(t.data("name"))
                            .css({ opacity: 1 })),
                        "district" == e &&
                            ((o = "ward"),
                            t
                                .closest(".form-infor")
                                .find("input[name=district_id]")
                                .val(t.data("id")),
                            t
                                .closest(".form-infor")
                                .find("input[name=ward_id]")
                                .val(""),
                            t
                                .closest(".form-infor")
                                .find("#customer_ward_id")
                                .text(
                                    $("#customer_ward_id").attr("placeholder")
                                ),
                            t
                                .closest(".form-infor")
                                .find("#customer_district_id")
                                .text(t.data("name"))
                                .css({ opacity: 1 }),
                            (i = "#search_address_ward")),
                        "provinces" == e &&
                            (t
                                .closest(".form-infor")
                                .find("input[name=province_id]")
                                .val(t.data("id")),
                            t
                                .closest(".form-infor")
                                .find("input[name=district_id]")
                                .val(""),
                            t
                                .closest(".form-infor")
                                .find("input[name=ward_id]")
                                .val(""),
                            t
                                .closest(".form-infor")
                                .find("#customer_district_id")
                                .text(
                                    $("#customer_district_id").attr(
                                        "placeholder"
                                    )
                                ),
                            t
                                .closest(".form-infor")
                                .find("#customer_ward_id")
                                .text(
                                    $("#customer_ward_id").attr("placeholder")
                                ),
                            t
                                .closest(".form-infor")
                                .find("#customer_province_id")
                                .text(t.data("name"))
                                .css({ opacity: 1 }),
                            t
                                .closest(".form-infor")
                                .find("#search_address_ward")
                                .empty()),
                        "countries" == e &&
                            ((o = "provinces"),
                            t
                                .closest(".form-infor")
                                .find("input[name=country_id]")
                                .val(t.data("id")),
                            t
                                .closest(".form-infor")
                                .find("input[name=province_id]")
                                .val(""),
                            t
                                .closest(".form-infor")
                                .find("input[name=district_id]")
                                .val(""),
                            t
                                .closest(".form-infor")
                                .find("input[name=ward_id]")
                                .val(""),
                            t
                                .closest(".form-infor")
                                .find("#customer_district_id")
                                .text(
                                    $("#customer_district_id").attr(
                                        "placeholder"
                                    )
                                ),
                            t
                                .closest(".form-infor")
                                .find("#customer_ward_id")
                                .text(
                                    $("#customer_ward_id").attr("placeholder")
                                ),
                            t
                                .closest(".form-infor")
                                .find("#customer_province_id")
                                .text(
                                    $("#customer_province_id").attr(
                                        "placeholder"
                                    )
                                ),
                            t
                                .closest(".form-infor")
                                .find("#customer_country_id")
                                .text(t.data("name"))
                                .css({ opacity: 1 }),
                            t
                                .closest(".form-infor")
                                .find("#search_address_district")
                                .empty(),
                            t
                                .closest(".form-infor")
                                .find("#search_address_ward")
                                .empty(),
                            (i = "#search_address_province")),
                        "ward" != e &&
                            $.ajax({
                                headers: {
                                    "X-CSRF-TOKEN": $(
                                        'meta[name="csrf-token"]'
                                    ).attr("content"),
                                },
                                url: "/ajax/address-suggest",
                                type: "POST",
                                dataType: "json",
                                data: { type: e, id: t.data("id") },
                                beforeSend: function () {
                                    loadingBox();
                                },
                                success: function (e) {
                                    ($html = ""),
                                        $.each(e, function (t, e) {
                                            $html +=
                                                '<li class="address-suggest-item"\n                            data-id="'
                                                    .concat(
                                                        e.id,
                                                        '"\n                            data-type="'
                                                    )
                                                    .concat(
                                                        o,
                                                        '"\n                            data-name="'
                                                    )
                                                    .concat(
                                                        e.name,
                                                        '"\n                            >'
                                                    )
                                                    .concat(e.name, "</li>");
                                        }),
                                        t
                                            .closest(".form-infor")
                                            .find(i)
                                            .html($html),
                                        loadingBox("close");
                                },
                                error: function () {
                                    loadingBox("close"),
                                        alert_show("error", errorMessage);
                                },
                            }),
                        t.closest(".form-row").removeClass("active");
                }
            ),
            $("body").on(
                "click",
                '.pyament-check button[type="submit"]',
                function (t) {
                    t.preventDefault(),
                        $(this).hasClass("active") ||
                            (validForm($(this).closest("form").attr("id")) &&
                                (loadingBox(),
                                $(this).addClass("active"),
                                $(this).closest("form").submit()));
                }
            ),
            $("body").on("click", ".radio-field > label input", function () {
                $(this)
                    .closest(".list-payment")
                    .find(".radio-field__description")
                    .hide(),
                    $(this).prop("checked") &&
                        $(this)
                            .closest(".radio-field")
                            .find(".radio-field__description")
                            .slideToggle();
            }),
            $("body").on(
                "click",
                ".cart-wrap__sidebar #vat-input",
                function () {
                    $(this).prop("checked") &&
                        ($("#vat-payment-popup").addClass("active"),
                        $(".edit-vat-info").show());
                }
            ),
            $("body").on("click", "#vat_use_address", function () {
                if ($(this).prop("checked")) {
                    var t = $("#input-address").val(),
                        e = $("#customer_ward_id").text(),
                        i = $("#customer_district_id").text(),
                        o = $("#customer_province_id").text();
                    $("#vat_address").val(
                        ""
                            .concat(t, ", ")
                            .concat(e, ", ")
                            .concat(i, ", ")
                            .concat(o)
                    );
                }
            }),
            $("body").on("keyup change", "#vat_address", function () {
                $("#vat_use_address").prop("checked") &&
                    ($("#vat_address").val(""),
                    $("#vat_use_address").prop("checked", !1));
            }),
            $("body").on("click", "*[data-popup_close]", function (t) {
                t.preventDefault(),
                    $(this).closest(".popup").removeClass("active"),
                    $("body").css("overflow", "auto"),
                    $(".cart-wrap__sidebar #vat-input").prop("checked", !1),
                    $(".edit-vat-info").hide();
            }),
            $("body").on("click", ".edit-vat-info", function (t) {
                t.preventDefault(), $("#vat-payment-popup").addClass("active");
            }),
            $("body").on(
                "click",
                ".popup-dialog__footer .accept-vat",
                function (t) {
                    t.preventDefault(),
                        validForm("vat-payment-popup", "input_field") &&
                            isEmail($("#vat_email").val()) &&
                            $("#vat-payment-popup").removeClass("active"),
                        isEmail($("#vat_email").val()) ||
                            $(".vat-input .err_show.email").addClass("active");
                }
            ),
            $("body").on(
                "change",
                'input[name="shipping_method"]',
                function () {
                    var t = $(this);
                    if (t.prop("checked")) {
                        var i = t.val(),
                            o = t
                                .closest("form")
                                .find('input[name="country_id"]')
                                .val(),
                            s = t
                                .closest("form")
                                .find('input[name="province_id"]')
                                .val(),
                            a = t
                                .closest("form")
                                .find('input[name="district_id"]')
                                .val(),
                            r = t
                                .closest("form")
                                .find('input[name="ward_id"]')
                                .val();
                        $(".list-shipping .radio-field__description")
                            .empty()
                            .hide(),
                            e({
                                shipping_method: i,
                                country_id: o,
                                province_id: s,
                                district_id: a,
                                ward_id: r,
                            });
                    }
                }
            ),
            $("body").on(
                "change",
                ".shipping_method_service input",
                function () {
                    var t = $(this);
                    if (t.prop("checked")) {
                        var e = t.data("valuefm"),
                            i = t.data("valuetotalfm");
                        $(".shipping-amount").text(e),
                            $(".summary-total-price").text(i);
                    }
                }
            ),
            $("body").on(
                "click",
                "#search_address_district .address-suggest-item",
                function () {
                    var t = $(this),
                        i = t
                            .closest("form")
                            .find('input[name="shipping_method"]:checked')
                            .val();
                    i &&
                        e({
                            shipping_method: i,
                            country_id: t
                                .closest("form")
                                .find('input[name="country_id"]')
                                .val(),
                            province_id: t
                                .closest("form")
                                .find('input[name="province_id"]')
                                .val(),
                            district_id: t
                                .closest("form")
                                .find('input[name="district_id"]')
                                .val(),
                            ward_id: t
                                .closest("form")
                                .find('input[name="ward_id"]')
                                .val(),
                        });
                }
            );
    }),
        (window.loadShippingFee = e),
        (window.TextToAlias = i);
})();
